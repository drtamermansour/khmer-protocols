Counting the reads that map to each feature
===========================================

After mapping of reads back to the transcriptome. Now it is time to figure out 
the expression level of each expression unit. There is two main flavours of this process:

.. toctree::
   :maxdepth: 2

   m-htseq
   m-cufflinks


----

:doc:`./m-htseq`

Simply count all the reads that map **uniquelly** to all exons of the gene. There are several 
software packages that can do this e.g. 
`htseq-count <http://www-huber.embl.de/users/anders/HTSeq/doc/count.html>`__.
and `Featurecount <http://bioinf.wehi.edu.au/featureCounts/>`__.
Both programs require the user to provide a gene model (Gene annotation file; GTF).
Annotaions file of model oraganisms are avaliable on all gene banks (e.g. 
`NCBI <http://www.ncbi.nlm.nih.gov/guide/howto/dwn-genome/>`__, 
`UCSC <http://hgdownload.cse.ucsc.edu/downloads.html>`__, and
`Ensemble <http://www.ensembl.org/info/data/ftp/index.html>`__). 
Also they are avaliable through other genomic software projects e.g. 
`Illumina iGenomes project <http://cufflinks.cbcb.umd.edu/igenomes.html>`__. 

----

:doc:`./m-cufflinks`

Mapping the reads to transcripts (gene isoforms) rather than the whole gene will enable 
the identification of changes in alterative splicaing machinary. 
`Cufflinks <http://cole-trapnell-lab.github.io/cufflinks/>`__ is the canonical software 
package to do that. Cufflinks can do the mapping based on avaliable annoataion files 
but also it can make its own gene model. This feature enables Cufflinks to predict denovo transcripts.
On the other hand, mapping to transcripts requires the implementation of error prone modeling 
approaches and thus requires rigorous laboratory confirmation. Cufflinks also 
pools the results of all transcripts per gene to give an answer similar to the one obtained from 
htseq-like packages. One comparative feature that should be considered is the tendency of Cufflinks to 
utilize ambiguously aligned reads (versus htseq wich use anly the uniquelly mapped reads). 
This feature might explain a lot of the differences in the output of the 2 softwares.
There are other softwares for analysis of differential splicing events (exon skipping, intron retention, etc.) 
e.g. `MATS <http://rnaseq-mats.sourceforge.net/>`__, and 
`MISO <http://genes.mit.edu/burgelab/miso/>`__.


----

Links:

* `Trapnell et al. 2013 Differential analysis of gene regulation at transcript resolution with RNA-seq <http://www.nature.com/nbt/journal/v31/n1/full/nbt.2450.html>`__

----

Next: :doc:`m-m-htseq`
